<div class="page-header">
  <h3>People</h3>
</div>
<% if @users.present? %>
  <table class="table ep-index__table">
    <tbody>
      <% @users.each do |user| %>
        <tr>
          <td>
            <div class="ep-index__photo">
              <% if user.avatar.url != "/images/original/missing.png" %>
                <%= image_tag("https://s3.amazonaws.com/ep-profilepics-avatar/#{user.id}", height: '50', width: '50') %>
              <% else %>
                <%= image_tag(user.image_url, height: '50', width: '50') %>
              <% end %>
            </div>
            <div class="ep-index__meta">
              <p><%= link_to user.name, user_path(user) %></p>
              <p><%= user.headline %></p>
              <p class="ep-index__meta-content">
                <% user.roles.each_with_index do |role, i| %>
                  <%= role.name %><%= "," unless i == user.roles.count - 1 %>
                <% end %>

                <%= user.roles.present? && user.subjects.present? ? '|' : '' %>

                <% user.subjects.each_with_index do |subject, i| %>
                  <%= subject.name %><%= "," unless i == user.subjects.count - 1 %>
                <% end %>
              </p>
            </div>
          </td>
          <% if current_user %>
            <td>
              <div class="ep_index--connection js_users--connection-<%= user.id %>">
                <%= render partial: 'users/user_connection', locals: { user: user } %>
              </div>
            </td>
          <% end %>
        </tr>
      <% end %>
    </tbody>
  </table>
<% else %>
  <p>Sorry, no matches. Try broadening your search.</p>
<% end %>
